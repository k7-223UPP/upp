Обозначим за dp[w][k] максимальную суммарную стоимость k предметов суммарным весом w. Таким образом, пара (w, k) образует состояние задачи.

Базовый случай: dp[0][0] = 1.

Правило пересчета: dp[w][k] = max_i (dp[w - w_i][k - 1] + c_i) при ограничении w_i &lt;= w, 1 &lt;= k, 1 &lt;= i &lt;= n.

Ответ на задачу -- max_{w, k} (dp[w][k]) при ограничении w &lt;= W.

Заметим, что некоторые состояния dp[w][k] не достижимы. В коде удобно это учитывать, полагая в таких состояниях dp[w][k] = - \infinity.