Задачу можно решить с помощью алгоритма Кнута-Морриса-Пратта. Подробное описание алгоритма можно найти по ссылке:
http://e-maxx.ru/algo/prefix_function